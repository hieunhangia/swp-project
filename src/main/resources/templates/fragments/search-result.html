<div layout:decorate="~{layouts/customer-layout}" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

    <div layout:fragment="content">

        <h1>Kết quả tìm kiếm</h1>
        <h2>Có <span th:text="${totalElement}"></span> sản phẩm phù hợp</h2>



        <!-- Category Dropdown -->
        <form method="get" th:action="@{${url}}">
            <label for="category">Lọc theo danh mục:</label>
            <input type="hidden" name="keyword" th:value="${keyword}" /> <!-- Preserve the search keyword -->
            <select name="categoryId" id="category" class="form-select form-select-sm" style="width: auto;"
                onchange="this.form.submit()">
                <option value="0" th:text="'Tất cả danh mục'" th:selected="${categoryId == 0}"></option>
                <option th:each="category : ${categories}" th:value="${category.id}" th:text="${category.name}"
                    th:selected="${category.id == categoryId}">
                </option>
            </select>
        </form>

        <!-- Products Table -->
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>ID Sản Phẩm</th>
                    <th>Ảnh</th>
                    <th>Tên sản phẩm</th>
                    <th>Giá</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="product : ${viewProductDto}">
                    <td th:text="${product.id}"></td>
                    <td><img th:src="${product.mainImageUrl}" alt="Product Image" style="width: 100px; height: auto;">
                    </td>
                    <td>
                        <a th:href="@{/product/{id}(id=${product.id})}" class="card-title h5" th:text="${product.name}"></a>
                    </td>
                    <td th:text="${product.price}"></td>
                </tr>
            </tbody>
        </table>

            <a th:href="@{${url}(page=${viewProductDto.number - 1}, size=${viewProductDto.size}, categoryId=${categoryId}, keyword=${keyword})}"
                th:if="${!viewProductDto.first}" class="btn btn-primary">Trước</a>
            <a th:href="@{${url}(page=${viewProductDto.number - 1}, size=${viewProductDto.size}, categoryId=${categoryId}, keyword=${keyword})}"
                th:if="${!viewProductDto.first}" class="btn btn-primary">Trước</a>
            <a th:href="@{${url}(page=${viewProductDto.number + 1}, size=${viewProductDto.size}, categoryId=${categoryId}, keyword=${keyword})}"
                th:if="${!viewProductDto.last}" class="btn btn-primary">Tiếp theo</a>
        </div>
    </div>
</div>