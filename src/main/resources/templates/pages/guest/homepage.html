<div layout:decorate="~{layouts/customer-layout}" xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

    <div layout:fragment="content">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <div class="container">
                    <h1 class="hero-title">
                        <i class="fas fa-leaf"></i> Ch√†o m·ª´ng ƒë·∫øn v·ªõi FruitShop
                    </h1>
                    <p class="hero-subtitle">
                        Kh√°m ph√° nh·ªØng s·∫£n ph·∫©m t∆∞∆°i ngon, ch·∫•t l∆∞·ª£ng cao v·ªõi gi√° c·∫£ h·ª£p l√Ω
                    </p>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <span class="stat-number">36+</span>
                            <span class="stat-label">S·∫£n ph·∫©m</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">3.6‚òÖ</span>
                            <span class="stat-label">ƒê√°nh gi√°</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="container">
            <!-- Category Filter Section -->
            <section class="filter-section">
                <form class="d-flex align-items-center gap-3 justify-content-center flex-wrap" th:action="@{/}" method="get">
                    <label for="category" class="filter-title">
                        <i class="fas fa-filter"></i> L·ªçc theo danh m·ª•c:
                    </label>
                    <select name="categoryId" id="category" class="filter-select" onchange="this.form.submit()">
                        <option value="0" th:text="'üè∑Ô∏è T·∫•t c·∫£ danh m·ª•c'" th:selected="${categoryId == null or categoryId == 0}">
                            üè∑Ô∏è T·∫•t c·∫£ danh m·ª•c
                        </option>
                        <option th:each="category : ${categories}" th:value="${category.id}" 
                                th:text="'üìÅ ' + ${category.name}" th:selected="${category.id == categoryId}">
                        </option>
                    </select>
                </form>
            </section>

            <!--Products Section -->
            <section class="product-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="section-icon">üåü</span>
                        <span th:if="${categoryId == 0}" th:text="'T·∫•t c·∫£ s·∫£n ph·∫©m'"></span>
                        <span th:if="${categoryId != 0}" th:text="'Xem s·∫£n ph·∫©m theo danh m·ª•c'"></span>
                    </h2>
                    <a th:href="@{/product-category-sorting(sortBy='default', categoryId=${categoryId})}" 
                       class="view-all-btn">
                        <i class="fas fa-arrow-right"></i> Xem t·∫•t c·∫£
                    </a>
                </div>
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                    <div class="col" th:each="product, iterStat : ${productByCategory}">
                        <div class="card product-card h-100">
                            <div class="product-image">
                                <img th:src="${product.main_image_url}" class="card-img-top" alt="Product Image">
                            </div>
                            <div class="card-body product-info">
                                <a th:href="@{/product/{id}(id=${product.id})}" class="product-title">
                                    <span th:text="${product.name}">Product Name</span>
                                </a>
                                <div class="product-price">
                                    <span th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Newest Products Section -->
            <section class="product-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="section-icon">‚ú®</span>
                        S·∫£n ph·∫©m m·ªõi nh·∫•t
                    </h2>
                    <a href="/product-category-sorting?sortBy=newest&categoryId=0" class="view-all-btn">
                        <i class="fas fa-arrow-right"></i> Xem t·∫•t c·∫£
                    </a>
                </div>
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                    <div class="col" th:each="product, iterStat : ${newestProducts}">
                        <div class="card product-card h-100">
                            <div class="product-image">
                                <img th:src="${product.main_image_url}" class="card-img-top" alt="Product Image">
                                <div class="product-badge" style="background: linear-gradient(45deg, #2196F3, #1976D2);">M·ªõi</div>
                            </div>
                            <div class="card-body product-info">
                                <a th:href="@{/product/{id}(id=${product.id})}" class="product-title">
                                    <span th:text="${product.name}">Product Name</span>
                                </a>
                                <div class="product-price">
                                    <span th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}">0</span>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                </div>
            </section>

            <!-- Best Selling Products Section -->
            <section class="product-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="section-icon">üî•</span>
                        S·∫£n ph·∫©m b√°n ch·∫°y nh·∫•t
                    </h2>
                    <a href="/product-category-sorting?sortBy=best-seller&categoryId=0" class="view-all-btn">
                        <i class="fas fa-arrow-right"></i> Xem t·∫•t c·∫£
                    </a>
                </div>
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                    <div class="col" th:each="product, iterStat : ${mostSoldProducts}">
                        <div class="card product-card h-100">
                            <div class="product-image">
                                <img th:src="${product.main_image_url}" class="card-img-top" alt="Product Image">
                                <div class="product-badge" style="background: linear-gradient(45deg, #FF5722, #D84315);">
                                    B√°n ch·∫°y
                                </div>
                            </div>
                            <div class="card-body product-info">
                                <a th:href="@{/product/{id}(id=${product.id})}" class="product-title">
                                    <span th:text="${product.name}">Product Name</span>
                                </a>
                                <div class="product-price">
                                    <span th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}">0</span>
                                    <span class="badge bg-danger ms-2" th:if="${product.soldQuantity > 0}">
                                        <i class="fas fa-fire"></i> <span th:text="${product.soldQuantity}">0</span> ƒë√£ b√°n
                                    </span>
                                </div>
                            </div>
                        
                        </div>
                    </div>
                </div>
            </section>

            <!-- Categories Showcase -->
            <section class="categories-showcase">
                <div class="text-center">
                    <h2 class="section-title justify-content-center">
                        <span class="section-icon">üìÇ</span>
                        Kh√°m ph√° danh m·ª•c
                    </h2>
                    <p class="text-muted">T√¨m ki·∫øm s·∫£n ph·∫©m theo danh m·ª•c y√™u th√≠ch</p>
                </div>
                <div class="category-grid">
                    <a th:each="category : ${categories}" 
                       th:href="@{/product-category-sorting(categoryId=${category.id})}" 
                       class="category-item">
                        <div class="category-icon">
                            <i class="fas fa-apple-alt"></i>
                        </div>
                        <div class="category-name" th:text="${category.name}">Category Name</div>
                    </a>
                </div>
            </section>
        </div>
    </div>
</div>