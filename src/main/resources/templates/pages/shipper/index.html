<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Trang Shipper</title>
  <link rel="stylesheet" href="/css/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body class="auth-body">
<div class="container py-4">
  
  <!-- Header + Logout -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 text-primary">üöö Trang Shipper</h1>
    <form th:action="@{/logout}" method="post">
      <button type="submit" class="btn btn-outline-danger btn-sm">ƒêƒÉng xu·∫•t</button>
    </form>
  </div>

  <!-- Alerts -->
  <div class="alerts-stack mb-3" style="width: fit-content; margin-left: auto;">
    <div class="alert alert-success alert-dismissible fade show" th:hidden="${msg == null}">
      <strong>Th√†nh c√¥ng!</strong> <span th:text="${msg}"></span>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <div class="alert alert-danger alert-dismissible fade show" th:hidden="${error == null}">
      <strong>Th·∫•t b·∫°i!</strong> <span th:text="${error}"></span>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  </div>

  <!-- Th·ªëng k√™ ƒë∆°n h√†ng -->
  <div class="auth-card p-4 shadow-sm">
    <h2 class="h5 mb-4 text-center text-secondary">üìä Th·ªëng k√™ ƒë∆°n h√†ng ƒë√£ giao</h2>
    <div class="row">
      <!-- B·∫£ng th·ªëng k√™ theo th√°ng -->
      <div class="col-lg-6 mb-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <h3 class="h6 text-primary mb-3 text-center">Theo th√°ng</h3>
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle text-center">
                <thead class="table-light">
                <tr>
                  <th>Th√°ng</th>
                  <th>S·ªë ƒë∆°n h√†ng</th>
                  <th>T·ª∑ l·ªá so v·ªõi tr∆∞·ªõc</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="i : ${#numbers.sequence(11,1)}">
                  <td th:text="${i} + ' th√°ng tr∆∞·ªõc'"></td>
                  <td th:text="${orderService.countDoneOrdersXMonthsAgo(principal, i)}">0</td>
                  <td th:text="${orderService.countPercentageComparedToThePreviousMonth(principal, i)} + '%'">0%</td>
                </tr>
                <tr class="fw-bold table-primary">
                  <td>Th√°ng n√†y</td>
                  <td th:text="${orderService.countDoneOrdersXMonthsAgo(principal, 0)}">0</td>
                  <td th:each="percentage : ${orderService.countPercentageComparedToThePreviousMonth(principal, 0)}"
                      th:text="${percentage == 0 ? '0%' : (percentage > 0 ? '+' + percentage + '%' : percentage + '%')}">0%</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- B·∫£ng th·ªëng k√™ theo ng√†y -->
      <div class="col-lg-6 mb-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <h3 class="h6 text-primary mb-3 text-center">Theo ng√†y</h3>
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle text-center">
                <thead class="table-light">
                <tr>
                  <th>Ng√†y</th>
                  <th>S·ªë ƒë∆°n h√†ng</th>
                  <th>T·ª∑ l·ªá so v·ªõi tr∆∞·ªõc</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="i : ${#numbers.sequence(6,1)}">
                  <td th:text="${i} + ' ng√†y tr∆∞·ªõc'"></td>
                  <td th:text="${orderService.countDoneOrdersXDaysAgo(principal, i)}">0</td>
                  <td th:text="${orderService.countPercentageComparedToThePreviousDay(principal, i)} + '%'">0%</td>
                </tr>
                <tr class="fw-bold table-primary">
                  <td>H√¥m nay</td>
                  <td th:text="${orderService.countDoneOrdersXDaysAgo(principal, 0)}">0</td>
                  <td th:each="percentage : ${orderService.countPercentageComparedToThePreviousDay(principal, 0)}"
                      th:text="${percentage == 0 ? '0%' : (percentage > 0 ? '+' + percentage + '%' : percentage + '%')}">0%</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="d-flex justify-content-center gap-3 mt-4">
      <a href="/shipper/delivering-orders" class="btn btn-outline-primary">üì¶ ƒê∆°n h√†ng ƒëang giao</a>
      <a href="/shipper/done-orders" class="btn btn-outline-success">‚úÖ ƒê∆°n h√†ng ƒë√£ giao</a>
    </div>
  </div>
</div>

<script src="/js/bootstrap/bootstrap.bundle.min.js"></script>
</body>
</html>
